# RNA-seq
.fastq, .fasta and.sra data handling with R/Bioconductor - QuasR

# download-SRA-convert-paired-fastq.R

* In case you start with .sra files instead of FASTQ or FASTA:
* Please install the fastq-dump for linux beforehand and add fastq-dump to the PATH.

Downloads experiment files (.sra).
Needs SraRunInfo.csv to be downloaded before execution.
From https://www.ncbi.nlm.nih.gov/sra query your dataset and then: Send to (top right corner), Select “File”,  Select format “RunInfo”,  Click on “Create File".
This script also creates the sampleFile.txt which is needed as input for the next script (alignment and counting).

# qAlign + qCount -> rnaseq.R
* Please install the QuasR package beforehand.

#Input types should be .fastq, .fasta or .bam files

#This script uses as input the files generated by download-SRA-convert-paired.fastq.R (fastq single or paired-end files and sampleFile.txt) and then aligns the data
#Produces BAM files which are used by qCount which produces the final gene count text file output.

#qAlign(sampleFile1, genomeFile) for single #bowtie
#qAlign(sampleFile1, genomeFile, splicedAlignement=TRUE) for paired-end #SpliceMap, 3 columns in sampleFile1 if pared-end (fastq1, fastq2, name)
#export(BSgenome.Hsapiens.NCBI.GRCh38::BSgenome.Hsapiens.NCBI.GRCh38, "BSgenome.Hsapiens.NCBI.GRCh38.fasta") #do once

* Important: same version of annotation file (.gtf) and genomeFile (.fasta)

# dif_exp.R
#edgeR
#Reads the count table created by QuasR as input (it removes the width column).
The user should manually add the "Symbol" column name above the first column (gene names) in the gene_count.txt file before executing dif_exp.R

The script final outputs the top 100 genes sorted by descending absolute fold change.
